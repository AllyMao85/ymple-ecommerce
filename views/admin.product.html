{% extends 'layout.html' %}

{% block title %} PRODUCT MANAGER {% endblock %}

{% block head %}
  {% parent %}
  <!-- STYLESHEETS -->
  <style>
    .ellipsis {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  </style>
  <!-- SCRIPTS -->
{% endblock %}

{% block content %}
<div class="container">
  <h1><a href="/admin"><i class="fa fa-fw fa-chevron-circle-left"></i></a>PRODUCT MANAGER</h1>
  <hr />

  {% if edit %}
  <form role="form" action="/product/{{ edit.id }}" method="POST">
  {% else %}
  <form role="form" action="/product" method="POST">
  {% endif %}
    <div class="row clearfix">
      <div class="col-lg-6">
        <div class="form-group">



          <Label for = "name"> {{__ ( 'name')}} </label>
                     <Input type = "text" class = "form-control" id = "name" name = "name" placeholder = "{{__ ( 'Please enter your name')__}}" value = "{{edit.name} } ">
                   </Div>
                 <Div class = "form-group">
                   <Label for = "price"> {{__ ( 'Price')}} </label>
                   <Input type = "text" class = "form-control" id = "price" name = "price" placeholder = "{{__ ( 'Please enter the price')}}" value = "{{edit.price} } ">
                 </Div>
                 <Div class = "form-group">
                   <Label for = "stock"> {{__ ( 'Inventory')}} </label>
                   <Input type = "text" class = "form-control" id = "stock" name = "stock" placeholder = "{{__ ( 'Please enter the inventory')}}" value = "{{edit.stock} } ">


        </div>
      </div>

      <div class="col-lg-6">
        <div class="form-group">


          <Label for = "video"> {{__ ( 'VIMEO Video ID')}} </ label> <br>
                    <Input type = "text" class = "form-control" id = "video" name = "video" placeholder = "{{__ ( 'VIMEO image ID input please.')}}" Value = "{{edit .video}} ">
                  </Div>
                <Div class = "form-group">
                  <Label for = "thumbnail"> {{__ ( 'representative picture')}} </ label> <br>
                  <Input type = "text" class = "form-control" id = "thumbnail" name = "thumbnail" placeholder = "{{__ ( 'representative image URL input please')}}" value = "{{edit. thumbnail}} ">
                </Div>
                <Div class = "form-group">
                  <Label for = "thumbnail"> {{__ ( 'Product photos')}} </ label> <br>
                  <Input type = "text" class = "form-control" id = "photos" name = "photos" placeholder = "{{__ ( 'product images URL to enter your (comma as the separator)')}}" value = "{{edit.photos}}">
                </Div>

                <-! <Div class = "form-group">
                  <Label for = "name"> {{__ ( 'product')}} </label>
                  <Select name = "related" class = "form-control">
                    <Option value = ""> {{__ ( 'No')}} </option>



            {% for product in products %}
            <option value="{{ product.id }}">{{ product.name }}</option>
            {% endfor %}
          </select>
        </div> -->
        <div class="form-group">



          <Label for = "tags"> {{__ ( 'tags')}} </ label>
          <Input type = "text" class = "form-control" id = "tags" name = "tags" placeholder = "{{__ ( 'Please enter tags separated by commas')}}" value = "{{ edit.tags}} ">


        </div>
      </div>
    </div>

    <div class="row clearfix">
      <div class="col-lg-12">
        <div class="form-group">


          <Label for = "description"> {{__ ( 'description')}} </label>
                     <Textarea class = "form-control" name = "description" id = "description" cols = "30" rows = "10"
                               placeholder = "{{__ ( 'the product to explain MARKDOWN format as input please') }} "> {{edit.description}} </textarea>
                   <!-- <Input type = "text" class = "form-control" id = "name" name = "name" placeholder = "{( 'Enter the name') {__}}"> -->

        </div>
        <!-- <div class="form-group" style="margin-left: 15px;">
          <div class="checkbox">
            <label>
              {% if edit.isSelling %}
              <input type="checkbox" name="isSelling" checked> {{ __('판매') }}
              {% else %}
              <input type="checkbox" name="isSelling"> {{ __('판매') }}
              {% endif %}
            </label>
          </div>
        </div> -->
        <p class="help-block">




          <I class = "fa fa-fw fa-warning"> </ i> {{__ ( 'When you register your product is stored in Unavailable state by default.
          Change your status by clicking the Status button at the bottom. ") }}
                     {% If edit%}
                     <Button type = "submit" class = "btn btn-primary btn-lg pull-right"> {{__ ( 'modify')}} </button>
                     {% Else%}
                     <Button type = "submit" class = "btn btn-primary btn-lg pull-right"> {{__ ( 'Register')}} </button>





          {% endif %}
        </p>
      </div>
    </div>
  </form>
  <hr />

  <div class="row">
    <div class="col-lg-12">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>#</th>





            <Th> {{__ ( 'one generation')}} </th>
                         <Th> {{__ ( 'name')}} </th>
                         <Th style = "width: 200px;"> {{__ ( 'Photo')}} </th>
                         <Th> {{__ ( 'Price')}} </th>
                         <Th> {{__ ( 'Inventory')}} </th>
                         <Th> {{__ ( 'product')}} </th>
                         <Th> {{__ ( 'tags')}} </th>
                         <Th> {{__ ( 'state')}} </th>






            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
          <tr data-id="{{ product.id }}">
            <td>{{ loop.index }}</td>
            <td>{{ product.createdAt|date('Y-m-d', '-540') }}</td>
            <td>{{ product.name }}</td>
            <td class="ellipsis">
              {% for photo in product.photos %}
              <a href="{{ product.photos }}">{{ loop.index }}</a>&nbsp;
              {% endfor %}
            </td>
            <td>{{ product.price|currency }}</td>
            <td>
              {% if product.stock > 0 %}
              {{ product.stock }}
              {% elseif product.stock == 0 %}


              {{ __('No stock') }}
                             {% Else%}
                             {{__ ( 'Unavailable')}}



              {% endif %}
            </td>
            <td>{{ product.related }}</td>
            <td>
              {% for tag in product.tags %}
              {{ tag }}{% if !loop.last %}, {% endif %}
              {% endfor %}
            </td>
            <td>
              {% if product.isSelling %}



              <Button class = "btn btn-xs btn-success" button-action = "status"> {{__ ( 'sale')}} </button>
                             {% Else%}
                             <Button class = "btn btn-xs btn-warning" button-action = "status"> {{__ ( 'Sell Stop')}} </button>





              {% endif %}
            </td>
            <td>
              <a href="/product/{{ product.id }}" class="btn btn-xs btn-default" button-action="edit">PREVIEW</a>
              <a href="/admin/product/{{ product.id }}" class="btn btn-xs btn-primary" button-action="edit">EDIT</a>
              <button class="btn btn-xs btn-danger" button-action="delete">DELETE</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <div style="text-align: center;">
        <ul class="pagination">
          <li><a href="/admin/product">&laquo;</a></li>
          {% for index in pages %}
          {% if page == loop.index %}
          <li class="active"><a href="/admin/product?page={{ loop.index }}">{{ loop.index }}</a></li>
          {% else %}
          <li><a href="/admin/product?page={{ loop.index }}">{{ loop.index }}</a></li>
          {% endif %}
          {% if loop.last %}
          <li><a href="/admin/product?page={{ loop.index }}">&raquo;</a></li>
          {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function () {
  $('[button-action="status"]').on('click', function () {
    var product_id = $(this).parent().parent().data('id');

    $.ajax({
      type: 'PUT',
      url: '/product/status/' + product_id,
      success: function (data, status) {
        alert('Status changed succesfully.');
        window.location = '/admin/product';
        return;
      },
      error: function (error) {
        console.log(error);
        return;
      }
    });
  });

  // POST DELETE
  $('[button-action="delete"]').on('click', function () {
    if ( !confirm ('Do you really want to delete this?') ) {
      return;
    }

    var product_id = $(this).parent().parent().data('id');

    $.ajax({
      type: 'DELETE',
      url: '/product/' + product_id,
      success: function (data, status) {
        alert('Deleted succesfully.');
        window.location = '/admin/product';
        return;
      },
      error: function (error) {
        console.log(error);
        return;
      }
    });
  });
});
</script>


{% endblock %}